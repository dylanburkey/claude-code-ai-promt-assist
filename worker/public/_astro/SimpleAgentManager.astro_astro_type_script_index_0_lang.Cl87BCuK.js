import{a as r}from"./api.Dv2Hb9xf.js";let s=[],m=null;document.addEventListener("DOMContentLoaded",async()=>{await g(),L()});async function g(){try{s=await r.agents.list(),u(),E()}catch(e){console.error("Failed to load agents:",e),d("Failed to load agents","error")}}function u(){const e=document.getElementById("agent-list");if(e){if(s.length===0){e.innerHTML='<div class="empty-state">No agents yet. Create one!</div>';return}e.innerHTML=s.map(t=>`
      <div class="item-card ${t.id===m?"active":""}" onclick="selectAgent('${t.id}')">
        <div class="item-card-header">
          <span class="item-name">${v(t.name)}</span>
          <button class="btn-ghost btn-xs" onclick="event.stopPropagation(); editAgent('${t.id}')" title="Edit">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
          </button>
        </div>
        <span class="item-preview">${v(t.role)}</span>
      </div>
    `).join("")}}function E(){const e=document.getElementById("agents-count");e&&(e.textContent=s.length.toString())}function I(e){m=e;const t=s.find(n=>n.id===e);if(t){const n=document.getElementById("current-agent-display"),o=document.getElementById("clear-agent-btn");if(n){const a=n.querySelector(".selection-tag-name");a&&(a.textContent=t.name),n.classList.add("has-selection")}o&&(o.style.display="block"),document.dispatchEvent(new CustomEvent("agent-selected",{detail:{agent:t}}))}u()}function p(){m=null;const e=document.getElementById("current-agent-display"),t=document.getElementById("clear-agent-btn");if(e){const n=e.querySelector(".selection-tag-name");n&&(n.textContent="No agent selected"),e.classList.remove("has-selection")}t&&(t.style.display="none"),u()}function B(e){const t=s.find(f=>f.id===e);if(!t)return;const n=document.getElementById("agent-modal"),o=document.getElementById("agent-id"),a=document.getElementById("agent-name"),c=document.getElementById("agent-role"),i=document.getElementById("agent-style"),l=document.getElementById("btn-delete-agent");o&&(o.value=t.id),a&&(a.value=t.name),c&&(c.value=t.role),i&&(i.value=t.style||""),l&&(l.style.display="block"),n&&(n.style.display="flex")}function h(){const e=document.getElementById("agent-modal"),t=e?.querySelector("form"),n=document.getElementById("btn-delete-agent");t&&t.reset(),n&&(n.style.display="none"),e&&(e.style.display="flex")}async function w(){const e=document.getElementById("agent-id"),t=document.getElementById("agent-name"),n=document.getElementById("agent-role"),o=document.getElementById("agent-style");if(!t||!n)return;const a=t.value.trim(),c=n.value.trim(),i=o.value.trim();if(!a||!c){d("Name and role are required","error");return}try{const l={name:a,role:c,style:i};e&&e.value?(await r.agents.update(e.value,l),d("Agent updated!")):(await r.agents.create(l),d("Agent created!")),await g(),y()}catch(l){console.error("Failed to save agent:",l),d("Failed to save agent","error")}}async function A(){const e=document.getElementById("agent-id");if(!e||!e.value)return;const t=s.find(n=>n.id===e.value);if(t&&confirm(`Delete agent "${t.name}"? This cannot be undone.`))try{await r.agents.delete(e.value),d("Agent deleted"),m===e.value&&p(),await g(),y()}catch(n){console.error("Failed to delete agent:",n),d("Failed to delete agent","error")}}function y(){const e=document.getElementById("agent-modal");e&&(e.style.display="none")}function L(){document.querySelector("#agents-section .collapsible-header")?.addEventListener("click",()=>{const e=document.getElementById("agents-section");e&&e.classList.toggle("collapsed")}),document.getElementById("new-agent-btn")?.addEventListener("click",h),document.getElementById("clear-agent-btn")?.addEventListener("click",p),document.getElementById("btn-save-agent")?.addEventListener("click",w),document.getElementById("btn-delete-agent")?.addEventListener("click",A),document.getElementById("btn-cancel-agent")?.addEventListener("click",y)}function v(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function d(e,t="success"){const n=document.getElementById("toast");n&&(n.textContent=e,n.className=`toast ${t} show`,setTimeout(()=>n.classList.remove("show"),3e3))}window.selectAgent=I;window.editAgent=B;
