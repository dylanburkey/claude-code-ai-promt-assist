import{a as y}from"./api.BoRAYT-2.js";let d=null;document.addEventListener("DOMContentLoaded",()=>{x(),document.addEventListener("project-changed",e=>{d=e.detail.projectId})});function x(){document.getElementById("open-export-modal-btn")?.addEventListener("click",f),document.getElementById("btn-start-export")?.addEventListener("click",h),document.getElementById("btn-cancel-export")?.addEventListener("click",u),document.getElementById("export-format")?.addEventListener("change",I)}function f(){const e=document.getElementById("export-modal"),t=document.getElementById("export-filename");t&&(t.value=d?`project-${d}`:"project-export"),e&&(e.style.display="flex")}function u(){const e=document.getElementById("export-modal"),t=document.getElementById("export-progress");t&&(t.style.display="none"),e&&(e.style.display="none")}function I(){const e=document.getElementById("export-format"),t=document.getElementById("include-prompts");!e||!t||(e.value==="claude-code"?(t.checked=!1,t.disabled=!0):t.disabled=!1)}async function h(){const e=document.getElementById("export-format"),t=document.getElementById("export-filename"),o=document.getElementById("include-agents"),s=document.getElementById("include-rules"),c=document.getElementById("include-hooks"),g=document.getElementById("include-prompts");if(!e||!t)return;const r=e.value,a=t.value.trim();if(!a){l("Please enter a filename","error");return}if(!d){l("No project selected","error");return}const E={agents:o?.checked||!1,rules:s?.checked||!1,hooks:c?.checked||!1,prompts:g?.checked||!1};try{i("Preparing export...",10);const m={format:r,filename:a,include:E};i("Generating export...",50);const p=await y.export.project(d,m);if(i("Download ready!",100),p.downloadUrl){const n=document.createElement("a");n.href=p.downloadUrl,n.download=`${a}.${r==="claude-code"?"xml":r}`,document.body.appendChild(n),n.click(),document.body.removeChild(n)}l("Export completed successfully!"),setTimeout(()=>u(),1e3)}catch(m){console.error("Export failed:",m),l("Export failed","error"),B()}}function i(e,t){const o=document.getElementById("export-progress"),s=document.getElementById("progress-status"),c=document.getElementById("progress-fill");o&&(o.style.display="block"),s&&(s.textContent=e),c&&(c.style.width=`${t}%`)}function B(){const e=document.getElementById("export-progress");e&&(e.style.display="none")}function l(e,t="success"){const o=document.getElementById("toast");o&&(o.textContent=e,o.className=`toast ${t} show`,setTimeout(()=>o.classList.remove("show"),3e3))}window.openExportModal=f;window.closeExportModal=u;
