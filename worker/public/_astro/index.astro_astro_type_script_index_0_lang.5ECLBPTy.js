import{a as c}from"./api.BlSEnePC.js";let i=[],l=[],d=null,s=null;document.addEventListener("DOMContentLoaded",async()=>{await p(),await v(),y(),window.innerWidth<769&&u("builder")});async function p(){try{i=await c.requirements.list(),h(),m()}catch(e){console.error("Failed to load requirements:",e),o("Failed to load requirements","error")}}async function v(){try{l=(await c.projects.list()).projects||[],E()}catch(e){console.error("Failed to load projects:",e),o("Failed to load projects","error")}}function u(e){if(window.innerWidth>=769)return;document.querySelectorAll(".panel").forEach(r=>r.classList.remove("active-view")),document.querySelectorAll(".mobile-tab").forEach(r=>r.classList.remove("active"));const t=document.getElementById(`view-${e}`);t&&t.classList.add("active-view");const n=document.querySelector(`[data-view="${e}"]`);n&&n.classList.add("active")}function f(e){d=e;const t=i.find(n=>n.id===e);t&&(document.dispatchEvent(new CustomEvent("requirement-selected",{detail:{requirement:t}})),c.requirements.trackUsage(e).catch(()=>{})),m()}function m(){const e=document.getElementById("requirement-list");if(e){if(i.length===0){e.innerHTML='<div class="empty-state">No requirements yet. Create one!</div>';return}e.innerHTML=i.map(t=>`
      <div class="item-card ${t.id===d?"active":""}" onclick="selectRequirement('${t.id}')">
        <div class="item-card-header">
          <span class="item-name">${a(t.name)}</span>
          <button class="btn-ghost btn-xs" onclick="event.stopPropagation(); editRequirement('${t.id}')" title="Edit">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
          </button>
        </div>
        <span class="item-preview">${a(t.requirements_content)}</span>
      </div>
    `).join("")}}function h(){const e=document.getElementById("requirements-count");e&&(e.textContent=i.length.toString())}function E(){const e=document.getElementById("current-project-select");e&&(e.innerHTML='<option value="">No Project Selected</option>',l.forEach(t=>{const n=document.createElement("option");n.value=t.id,n.textContent=t.name,e.appendChild(n)}))}function g(){const e=document.getElementById("output-display");if(!e)return;const t=e.textContent;if(!t||t.includes("Generated prompt will appear here")){o("No prompt to copy","error");return}navigator.clipboard.writeText(t).then(()=>o("Copied!")).catch(()=>o("Failed to copy","error"))}function y(){document.querySelectorAll(".mobile-tab").forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-view");t&&u(t)})}),document.querySelectorAll(".collapsible-header").forEach(e=>{e.addEventListener("click",()=>{const t=e.closest(".collapsible-section");t&&t.classList.toggle("collapsed")})}),document.getElementById("copy-btn")?.addEventListener("click",g),document.getElementById("current-project-select")?.addEventListener("change",e=>{s=e.target.value,document.dispatchEvent(new CustomEvent("project-changed",{detail:{projectId:s}}))}),document.getElementById("close-sidebar")?.addEventListener("click",()=>{const e=document.getElementById("sidebar-panel");e&&e.classList.remove("mobile-open")}),document.addEventListener("prompt-generated",e=>{const t=document.getElementById("output-display");t&&(t.textContent=e.detail.prompt,t.classList.remove("output-placeholder"))})}function a(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function o(e,t="success"){const n=document.getElementById("toast");n&&(n.textContent=e,n.className=`toast ${t} show`,setTimeout(()=>n.classList.remove("show"),3e3))}window.selectRequirement=f;window.editRequirement=e=>console.log("Edit requirement:",e);
